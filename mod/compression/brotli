#!/bin/sh
if ! command -v brotli >/dev/null 2>&1; then
	warning 'could not find brotli' 'brotli'
	return
fi

hook '9' 'hook_brotli'
hook_brotli() {
	brotli_compression_level="${brotli_compression_level:-9}"
	echo "${out##*.}" | grep -Eq "^(${compression_filter:-html|css|js})$" || return
	debug "compressing $out; level: $brotli_compression_level" 'brotli'
	brotli "-kf$brotli_compression_level" "$out"
}
